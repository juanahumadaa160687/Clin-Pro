{% extends 'base_funcionarios.html' %}
{% load static %}
{% load sweetify %}
{% sweetify %}


{% block title %}Dashboard Funcionarios{% endblock %}

{% block content %}

    {% if messages %}
        {% for message in messages %}
            {% if message.tags == 'success' %}
                <div class="alert alert-success alert-dismissible fade show" role="alert" style="width: 30%;">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% elif message.tags == 'error' %}
                <div class="alert alert-danger alert-dismissible fade show" role="alert" style="width: 30%;">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% elif message.tags == 'warning' %}
                <div class="alert alert-warning alert-dismissible fade show" role="alert" style="width: 30%;">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endif %}
        {% endfor %}
    {% endif %}

    <div class="m-0 p-0 d-flex justify-content-center align-items-center flex-column" style="min-height: 100vh; overflow-y: auto;">

        <div class="mb-2 p-0 w-100" >
            <h1 class="text-start" style="font-weight: bold; color: #4b4d39">Funcionarios</h1>
        </div>

        <div class="row gap-2 w-100">

            <div class="col card mb-2 p-0" style="background-color: #fefbf6; border: 1px solid #4b4d39;">
                <div class="card-header" style="background-color: #4b4d39; border: 1px solid #4b4d39;"><h5 class="card-title" style="color: #fefbf6;">Registro de Usuarios</h5> </div>
                <div class="card-body p-4 m-0">
                    <div class="d-flex justify-content-center flex-column align-items-center">
                        {% if form.non_field_errors %}
                            <div class="alert alert-danger" role="alert">
                                {{ form.non_field_errors }}
                            </div>
                        {% endif %}
                        <form method="POST" enctype="multipart/form-data" class="row g-3 text-white" name="registro" id="registro" style="width: 90%;">
                            {% csrf_token %}
                            <div class="col-4 form-group mb-1">
                                {{ form.rut.label }}
                                {{ form.rut }}
                            </div>
                            <div class="col-4 form-group mb-1">
                                {{ form.nombre.label }}
                                {{ form.nombre }}
                            </div>
                            <div class="col-4 form-group mb-1">
                                {{ form.telefono.label }}
                                {{ form.telefono }}
                            </div>
                            <div class="col-4 form-group mb-1">
                                {{ form.email.label }}
                                {{ form.email }}
                            </div>
                            <div class="col-4 form-group mb-1">
                                {{ form.password1.label }}
                                {{ form.password1 }}
                            </div>
                            <div class="col-4 form-group mb-1" >
                                {{ form.password2.label }}
                                {{ form.password2 }}
                            </div>
                            <div class="col-4 form-group mb-1">
                                {{ form.rol.label }}
                                {{ form.rol }}
                            </div>
                            <div class="w-100 d-flex justify-content-center flex-column align-items-end mt-1">
                                <button type="submit" class="btn" name="registro" id="registro" style="width: 20%; background-color: #4b4d39; border: 1px solid #4b4d39; color: #fefbf6;">Registrar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="row gap-2 w-100 h-100 mb-3 mt-3">

            <div class="col card p-0" style="background-color: #fefbf6; border: 1px solid #4b4d39;">
                <div class="card-header" style="background-color: #4b4d39; border: 1px solid #4b4d39;"><h5 class="card-title" style="color: #fefbf6;">Registro de Usuarios</h5> </div>
                <div class="card-body p-4 m-0">
                    <div class="mt-3 d-flex justify-content-center flex-column align-items-center">
                        {% if per_salud_form.non_field_errors %}
                            <div class="alert alert-danger" role="alert">
                                {{ per_salud_form.non_field_errors }}
                            </div>
                        {% endif %}
                        <form method="POST" enctype="multipart/form-data" class="row g-3 text-white" style="width: 90%;">
                            {% csrf_token %}
                            <div class="col-3 form-group mb-2">
                                {{ per_salud_form.prefijo.label }}
                                {{ per_salud_form.prefijo }}
                            </div>
                            <div class="col-9 form-group mb-2">
                                {{ per_salud_form.titulo.label }}
                                {{ per_salud_form.titulo }}
                            </div>
                            <div class="col-6 form-group mb-2">
                                {{ per_salud_form.especialidad.label }}
                                {{ per_salud_form.especialidad }}
                            </div>
                            <div class="col-6 form-group mb-2">
                                {{ per_salud_form.universidad.label }}
                                {{ per_salud_form.universidad }}
                            </div>
                            <div class="col-6 form-group mb-2">
                                {{ per_salud_form.user.label }}
                                {{ per_salud_form.user }}
                            </div>
                            <div class="col-6 form-group mb-2 d-flex justify-content-end flex-column align-items-end">
                                <button type="submit" class="btn" name="personal_salud" id="personal_salud" style="width: 40%; background-color: #4b4d39; border: 1px solid #4b4d39; color: #fefbf6;">Registrar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block script %}
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.datatables.net/2.3.0/js/dataTables.js"></script>

    <script>

        let table = new DataTable('#tableProc',{
            data: [
                {% for personal in personal_servicio %}
                    {
                        id: '{{ personal.personal__user_id }}',
                        titulo: '{{ personal.personal__user__rut }}',
                        especialidad: '{{ personal.personal__user__nombre }}',
                        universidad: '{{ personal.personal__user__email }}',
                        acciones: '<a href="#" class="btn btn-primary btn-sm"><i class="fa-solid fa-pen-to-square"></i></a> <a href="#" class="btn btn-danger btn-sm"><i class="fa-solid fa-trash"></i></a>',
                    },
                {% endfor %}
            ],
            columns: [
                { data: 'id', visible: false },
                { data: 'titulo' },
                { data: 'especialidad' },
                { data: 'universidad' },
                { data: 'acciones' },
            ],
        });
    </script>
{% endblock script %}